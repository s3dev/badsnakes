

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Module: collector.py &mdash; badsnakes - v0.1.0 Documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="_static/css/s5defs-rules.css?v=0345028d" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=2caa9db7"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Module: config.py" href="config.html" />
    <link rel="prev" title="Module: badsnakes.py" href="badsnakes.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            badsnakes
              <img src="_static/s3dev_tri_white_sm.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="library.html">Libary API Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="library.html#use-cases">Use Cases</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="library.html#module-documentation">Module Documentation</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="analysers.html">Module: analysers.py</a></li>
<li class="toctree-l3"><a class="reference internal" href="badsnakes.html">Module: badsnakes.py</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Module: collector.py</a></li>
<li class="toctree-l3"><a class="reference internal" href="config.html">Module: config.py</a></li>
<li class="toctree-l3"><a class="reference internal" href="containers.html">Module: containers.py</a></li>
<li class="toctree-l3"><a class="reference internal" href="enums.html">Module: enums.py</a></li>
<li class="toctree-l3"><a class="reference internal" href="extractor.html">Module: extractor.py</a></li>
<li class="toctree-l3"><a class="reference internal" href="logger.html">Module: logger.py</a></li>
<li class="toctree-l3"><a class="reference internal" href="module.html">Module: module.py</a></li>
<li class="toctree-l3"><a class="reference internal" href="parser.html">Module: parser.py</a></li>
<li class="toctree-l3"><a class="reference internal" href="reporter.html">Module: reporter.py</a></li>
<li class="toctree-l3"><a class="reference internal" href="utilities.html">Module: utilities.py</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Change Log</a></li>
<li class="toctree-l1"><a class="reference internal" href="contact.html">Contact Us</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">badsnakes</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="library.html">Libary API Documentation</a></li>
      <li class="breadcrumb-item active">Module: collector.py</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-badsnakes.libs.collector">
<span id="module-collector-py"></span><h1>Module: collector.py<a class="headerlink" href="#module-badsnakes.libs.collector" title="Link to this heading"></a></h1>
<dl class="field-list">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>This module provides file collection functionality to the
project.</p>
<p>Specifically, this module is called by
<a class="reference internal" href="badsnakes.html#badsnakes.badsnakes.BadSnakes.main" title="badsnakes.badsnakes.BadSnakes.main"><code class="xref py py-class docutils literal notranslate"><span class="pre">badsnakes.badsnakes.BadSnakes.main</span></code></a> to populate the
‘files list’ which holds all files to be analysed.</p>
<p>The CLI argument <code class="docutils literal notranslate"><span class="pre">PATH</span></code> is passed into this module, which
then traverses either the list of files, the directory or
extracts the wheel, in efforts to determine the files which
should be analysed. These files are passed back to the caller
via the <code class="xref py py-attr docutils literal notranslate"><span class="pre">files</span></code> property.</p>
</dd>
<dt class="field-even">Platform<span class="colon">:</span></dt>
<dd class="field-even"><p>Linux/Windows | Python 3.10+</p>
</dd>
<dt class="field-odd">Developer<span class="colon">:</span></dt>
<dd class="field-odd"><p>J Berendt</p>
</dd>
<dt class="field-even">Email<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="mailto:development&#37;&#52;&#48;s3dev&#46;uk">development<span>&#64;</span>s3dev<span>&#46;</span>uk</a></p>
</dd>
<dt class="field-odd">Comments<span class="colon">:</span></dt>
<dd class="field-odd"><p>n/a</p>
</dd>
<dt class="field-even">Examples<span class="colon">:</span></dt>
<dd class="field-even"><p>Collect plain-text files from a given <em>directory</em>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">badsnakes.libs.collector</span> <span class="kn">import</span> <span class="n">Collector</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">Collector</span><span class="p">(</span><span class="n">paths</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;/path/to/files&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="o">.</span><span class="n">files</span>

<span class="go">[[&#39;/path/to/files/project.py&#39;,</span>
<span class="go">  &#39;/path/to/files/script.sh&#39;]]</span>
</pre></div>
</div>
<p>Collect plain-text files from a Python <em>wheel</em>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">badsnakes.libs.collector</span> <span class="kn">import</span> <span class="n">Collector</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">Collector</span><span class="p">(</span><span class="n">paths</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;/path/to/project-0.7.3-py3-none-any.whl&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="o">.</span><span class="n">files</span>

<span class="go">[[&#39;/tmp/tmpqnm6yka2/project/module00.py&#39;,</span>
<span class="go">  &#39;/tmp/tmpqnm6yka2/project/module01.py&#39;,</span>
<span class="go">  &#39;/tmp/tmpqnm6yka2/project/module02.py&#39;,</span>
<span class="go">  ...,</span>
<span class="go">  &#39;/tmp/tmpqnm6yka2/project/script.sh&#39;,</span>
<span class="go">  &#39;/tmp/tmpqnm6yka2/project/file.txt&#39;,</span>
<span class="go">  ...,</span>
<span class="go">  &#39;/tmp/tmpqnm6yka2/project/module08.py&#39;,</span>
<span class="go">  &#39;/tmp/tmpqnm6yka2/project/module09.py&#39;,</span>
<span class="go">  &#39;/tmp/tmpqnm6yka2/project/module10.py&#39;]]</span>
</pre></div>
</div>
</dd>
</dl>
<dl class="py exception">
<dt class="sig sig-object py" id="badsnakes.libs.collector.MixedTypesError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">badsnakes.libs.collector.</span></span><span class="sig-name descname"><span class="pre">MixedTypesError</span></span><a class="reference internal" href="_modules/badsnakes/libs/collector.html#MixedTypesError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#badsnakes.libs.collector.MixedTypesError" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>Custom error class raised for mixed <code class="docutils literal notranslate"><span class="pre">PATH</span></code> type errors.</p>
<dl class="py method">
<dt class="sig sig-object py" id="badsnakes.libs.collector.MixedTypesError.add_note">
<span class="sig-name descname"><span class="pre">add_note</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#badsnakes.libs.collector.MixedTypesError.add_note" title="Link to this definition"></a></dt>
<dd><p>Exception.add_note(note) –
add a note to the exception</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="badsnakes.libs.collector.MixedTypesError.with_traceback">
<span class="sig-name descname"><span class="pre">with_traceback</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#badsnakes.libs.collector.MixedTypesError.with_traceback" title="Link to this definition"></a></dt>
<dd><p>Exception.with_traceback(tb) –
set self.__traceback__ to tb and return self.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="badsnakes.libs.collector._CollectorBase">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">badsnakes.libs.collector.</span></span><span class="sig-name descname"><span class="pre">_CollectorBase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/badsnakes/libs/collector.html#_CollectorBase"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#badsnakes.libs.collector._CollectorBase" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Private base class providing file collection functionality.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>path</strong> (<em>str</em>) – Full path to the module, directory or wheel for
collection.</p>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="badsnakes.libs.collector._CollectorBase.files">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">files</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span></em><a class="headerlink" href="#badsnakes.libs.collector._CollectorBase.files" title="Link to this definition"></a></dt>
<dd><p>Accessor to the list of collected files.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="badsnakes.libs.collector._CollectorBase.collect">
<span class="sig-name descname"><span class="pre">collect</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/badsnakes/libs/collector.html#_CollectorBase.collect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#badsnakes.libs.collector._CollectorBase.collect" title="Link to this definition"></a></dt>
<dd><p>Collect all files for this class-type.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="badsnakes.libs.collector._CollectorDirectory">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">badsnakes.libs.collector.</span></span><span class="sig-name descname"><span class="pre">_CollectorDirectory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/badsnakes/libs/collector.html#_CollectorDirectory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#badsnakes.libs.collector._CollectorDirectory" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#badsnakes.libs.collector._CollectorBase" title="badsnakes.libs.collector._CollectorBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">_CollectorBase</span></code></a></p>
<p>Collect all files for analysis from the given directory.</p>
<p>This <em>private</em> class is not part of the public interface. Please call the
<a class="reference internal" href="#badsnakes.libs.collector.Collector" title="badsnakes.libs.collector.Collector"><code class="xref py py-class docutils literal notranslate"><span class="pre">Collector</span></code></a> class instead.</p>
<dl class="py method">
<dt class="sig sig-object py" id="badsnakes.libs.collector._CollectorDirectory.collect">
<span class="sig-name descname"><span class="pre">collect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/badsnakes/libs/collector.html#_CollectorDirectory.collect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#badsnakes.libs.collector._CollectorDirectory.collect" title="Link to this definition"></a></dt>
<dd><p>Collect all files for this class-type.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>path</strong> (<em>str</em><em>, </em><em>optional</em>) – Directory path. This argument was
originally implemented for use by <a class="reference internal" href="#badsnakes.libs.collector._CollectorWheel" title="badsnakes.libs.collector._CollectorWheel"><code class="xref py py-class docutils literal notranslate"><span class="pre">_CollectorWheel</span></code></a>
to enable directory traversal using existing logic.
Defaults to None.</p>
</dd>
<dt class="field-even">Logic<span class="colon">:</span></dt>
<dd class="field-even"><ol class="arabic simple">
<li><p>Using <code class="docutils literal notranslate"><span class="pre">glob.glob</span></code> recursively, all files (including
hidden files) are collected.</p></li>
<li><p>Next, using <code class="docutils literal notranslate"><span class="pre">filter</span></code> remove any files which match the
exclusion pattern and are not plain-text. See <em>Tip</em> below.</p></li>
<li><p>Map <code class="docutils literal notranslate"><span class="pre">os.path.realpath</span></code> to all files to expand the
filepaths.</p></li>
</ol>
</dd>
</dl>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The excluded directories are maintained by the list in
<code class="docutils literal notranslate"><span class="pre">config.toml</span></code> under the <code class="docutils literal notranslate"><span class="pre">system.exclude_dirs</span></code> key.</p>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="badsnakes.libs.collector._CollectorDirectory.files">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">files</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span></em><a class="headerlink" href="#badsnakes.libs.collector._CollectorDirectory.files" title="Link to this definition"></a></dt>
<dd><p>Accessor to the list of collected files.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="badsnakes.libs.collector._CollectorWheel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">badsnakes.libs.collector.</span></span><span class="sig-name descname"><span class="pre">_CollectorWheel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/badsnakes/libs/collector.html#_CollectorWheel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#badsnakes.libs.collector._CollectorWheel" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#badsnakes.libs.collector._CollectorBase" title="badsnakes.libs.collector._CollectorBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">_CollectorBase</span></code></a></p>
<p>Collect all files for analysis from a Python wheel.</p>
<p>This <em>private</em> class is not part of the public interface. Please call the
<a class="reference internal" href="#badsnakes.libs.collector.Collector" title="badsnakes.libs.collector.Collector"><code class="xref py py-class docutils literal notranslate"><span class="pre">Collector</span></code></a> class instead.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>path</strong> (<em>str</em>) – Full path to the wheel file.</p>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="badsnakes.libs.collector._CollectorWheel.tmpdir">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">tmpdir</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">TemporaryDirectory</span></em><a class="headerlink" href="#badsnakes.libs.collector._CollectorWheel.tmpdir" title="Link to this definition"></a></dt>
<dd><p>Accessor to the temporary directory object.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="badsnakes.libs.collector._CollectorWheel.collect">
<span class="sig-name descname"><span class="pre">collect</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/badsnakes/libs/collector.html#_CollectorWheel.collect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#badsnakes.libs.collector._CollectorWheel.collect" title="Link to this definition"></a></dt>
<dd><p>Unzip a wheel file and collect files.</p>
<dl class="field-list">
<dt class="field-odd">Logic<span class="colon">:</span></dt>
<dd class="field-odd"><ol class="arabic simple">
<li><p>Create a temporary directory object (using <code class="docutils literal notranslate"><span class="pre">tempfile</span></code>).</p></li>
<li><p>Using <code class="docutils literal notranslate"><span class="pre">zipfile</span></code>, unzip the wheel into the temporary
directory.</p></li>
<li><p>Create an instance of the <a class="reference internal" href="#badsnakes.libs.collector._CollectorDirectory" title="badsnakes.libs.collector._CollectorDirectory"><code class="xref py py-class docutils literal notranslate"><span class="pre">_CollectorDirectory</span></code></a>
class and pass the path to the temp directory into the
class for file collection.</p></li>
<li><p>Store the list of collected files into the <code class="xref py py-attr docutils literal notranslate"><span class="pre">_files</span></code>
attribute.</p></li>
</ol>
</dd>
<dt class="field-even">Temp Directory<span class="colon">:</span></dt>
<dd class="field-even"><p>The <code class="xref py py-class docutils literal notranslate"><span class="pre">tempfile.TemporaryDirectory</span></code> object created by
this method is <em>not</em> explicitly closed, as the directory must
exist for analysing the files. Therefore, the temp directory
is removed when the <code class="docutils literal notranslate"><span class="pre">tmpdir</span></code> object has been destroyed,
generally on program completion.</p>
<p>For this reason, the object must be kept ‘alive’ in the class
instance, and therefore <em>cannot</em> be a local variable. To keep
the object alive, the class’ instance of the temp directory
object is appended to a list in the parent class.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="badsnakes.libs.collector._CollectorWheel.files">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">files</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span></em><a class="headerlink" href="#badsnakes.libs.collector._CollectorWheel.files" title="Link to this definition"></a></dt>
<dd><p>Accessor to the list of collected files.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="badsnakes.libs.collector.Collector">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">badsnakes.libs.collector.</span></span><span class="sig-name descname"><span class="pre">Collector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">paths</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/badsnakes/libs/collector.html#Collector"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#badsnakes.libs.collector.Collector" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Primary file collection interface class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>paths</strong> (<em>list</em>) – A list of file paths or directories from the
argument parser.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>On instantiation, all elements in the <code class="docutils literal notranslate"><span class="pre">paths</span></code> list argument are
expanded to their realpath and tested to ensure they exist.</p>
</div>
<dl class="py property">
<dt class="sig sig-object py" id="badsnakes.libs.collector.Collector.files">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">files</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span></em><a class="headerlink" href="#badsnakes.libs.collector.Collector.files" title="Link to this definition"></a></dt>
<dd><p>Accessor to the list of Python files to be analysed.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This property is a <em>list of lists</em>.</p>
<p>Each outer list represents a wheel or a directory, with each
inner list representing the files contained therein.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="badsnakes.libs.collector.Collector.collect">
<span class="sig-name descname"><span class="pre">collect</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/badsnakes/libs/collector.html#Collector.collect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#badsnakes.libs.collector.Collector.collect" title="Link to this definition"></a></dt>
<dd><p>Collect files for analysis from the provided paths.</p>
<dl class="field-list">
<dt class="field-odd">Criteria<span class="colon">:</span></dt>
<dd class="field-odd"><p>Using the private <a class="reference internal" href="#badsnakes.libs.collector.Collector._identify" title="badsnakes.libs.collector.Collector._identify"><code class="xref py py-meth docutils literal notranslate"><span class="pre">_identify()</span></code></a> method, the file
collection is routed to the appropriate file collector based
on the type of path provided to the <code class="docutils literal notranslate"><span class="pre">paths</span></code> argument on
instantiation.</p>
<ul class="simple">
<li><p><strong>Directory</strong>: All paths in the <code class="xref py py-attr docutils literal notranslate"><span class="pre">_paths</span></code> attribute
must be directories.</p></li>
<li><p><strong>Module</strong>: All paths in the <code class="xref py py-attr docutils literal notranslate"><span class="pre">_paths</span></code> attribute must
be plain-text files.</p></li>
<li><p><strong>Wheel</strong>: All paths in the <code class="xref py py-attr docutils literal notranslate"><span class="pre">_paths</span></code> attributes must
be Python wheels, or zip files.</p></li>
</ul>
<p>Only files of the same type (directory, module or wheel) can
be collected at the same time, otherwise a <code class="docutils literal notranslate"><span class="pre">ValueError</span></code> is
raised.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#badsnakes.libs.collector.MixedTypesError" title="badsnakes.libs.collector.MixedTypesError"><strong>MixedTypesError</strong></a> – Raised if the <code class="xref py py-attr docutils literal notranslate"><span class="pre">_paths</span></code> attribute contains
    a mix of the types listed above.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="badsnakes.libs.collector.Collector._checks">
<span class="sig-name descname"><span class="pre">_checks</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/badsnakes/libs/collector.html#Collector._checks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#badsnakes.libs.collector.Collector._checks" title="Link to this definition"></a></dt>
<dd><p>Perform pre-collection checks.</p>
<dl class="field-list simple">
<dt class="field-odd">Checks<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p>All files exist.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>FileNotFoundError</strong> – Raised if any file in <code class="docutils literal notranslate"><span class="pre">paths</span></code> does not
    exist.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="badsnakes.libs.collector.Collector._collect_from_directory">
<span class="sig-name descname"><span class="pre">_collect_from_directory</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/badsnakes/libs/collector.html#Collector._collect_from_directory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#badsnakes.libs.collector.Collector._collect_from_directory" title="Link to this definition"></a></dt>
<dd><p>Collect all plain-text files from a directory.</p>
<p>Before this method is called, all paths are tested to ensure
they are directories.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="badsnakes.libs.collector.Collector._collect_from_files">
<span class="sig-name descname"><span class="pre">_collect_from_files</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/badsnakes/libs/collector.html#Collector._collect_from_files"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#badsnakes.libs.collector.Collector._collect_from_files" title="Link to this definition"></a></dt>
<dd><p>Collect all plain-text files.</p>
<p>As the realpath conversion and file exists check have already
been performed, this method can simply append the <code class="xref py py-attr docutils literal notranslate"><span class="pre">_paths</span></code>
argument to <code class="xref py py-attr docutils literal notranslate"><span class="pre">_files</span></code>, for the caller’s use.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="badsnakes.libs.collector.Collector._collect_from_wheel">
<span class="sig-name descname"><span class="pre">_collect_from_wheel</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/badsnakes/libs/collector.html#Collector._collect_from_wheel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#badsnakes.libs.collector.Collector._collect_from_wheel" title="Link to this definition"></a></dt>
<dd><p>Collect all plain-text files from wheels.</p>
<p>Before this method is called, all paths are tested to ensure
they are wheels (or .zip files).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="badsnakes.libs.collector.Collector._identify">
<span class="sig-name descname"><span class="pre">_identify</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="_modules/badsnakes/libs/collector.html#Collector._identify"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#badsnakes.libs.collector.Collector._identify" title="Link to this definition"></a></dt>
<dd><p>Identify the type of collection to take place.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>One of the following strings are returned, based on the
content of the <code class="docutils literal notranslate"><span class="pre">paths</span></code> argument:</p>
<blockquote>
<div><ul class="simple">
<li><p>Directory: ‘dir’</p></li>
<li><p>Python modules: ‘modules’</p></li>
<li><p>Wheel: ‘wheel’</p></li>
<li><p>Anything else: ‘invalid’</p></li>
</ul>
</div></blockquote>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="badsnakes.libs.collector.Collector._isdir">
<span class="sig-name descname"><span class="pre">_isdir</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/badsnakes/libs/collector.html#Collector._isdir"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#badsnakes.libs.collector.Collector._isdir" title="Link to this definition"></a></dt>
<dd><p>Test if <em>all</em> elements of <code class="docutils literal notranslate"><span class="pre">paths</span></code> are directories.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>True if <em>all</em> paths are directories, otherwise False.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="badsnakes.libs.collector.Collector._istext">
<span class="sig-name descname"><span class="pre">_istext</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/badsnakes/libs/collector.html#Collector._istext"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#badsnakes.libs.collector.Collector._istext" title="Link to this definition"></a></dt>
<dd><p>Test if <em>all</em> elements of <code class="docutils literal notranslate"><span class="pre">paths</span></code> are plain-text files.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>True if <em>all</em> elements of <code class="docutils literal notranslate"><span class="pre">paths</span></code> are plain-text
files, otherwise False.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="badsnakes.libs.collector.Collector._iswheel">
<span class="sig-name descname"><span class="pre">_iswheel</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/badsnakes/libs/collector.html#Collector._iswheel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#badsnakes.libs.collector.Collector._iswheel" title="Link to this definition"></a></dt>
<dd><p>Test if <em>all</em> elements of <code class="docutils literal notranslate"><span class="pre">paths</span></code> are Python wheels.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A file is tested as a wheel by checking the first four bytes
of the file itself, <em>not</em> using the file extension. As such
a <code class="docutils literal notranslate"><span class="pre">.zip</span></code> file will pass this test as well.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>True if <em>all</em> elements of <code class="docutils literal notranslate"><span class="pre">paths</span></code> are Python wheels
(or ZIP archives), otherwise False.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="badsnakes.html" class="btn btn-neutral float-left" title="Module: badsnakes.py" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="config.html" class="btn btn-neutral float-right" title="Module: config.py" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024-2025 | s3dev | version 0.1.0.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>